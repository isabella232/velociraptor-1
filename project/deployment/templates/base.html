{% load current_nav %}
{% load static from staticfiles %}
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>{% block title %}{% if site_title %}{{ site_title }}{% else %}Velociraptor{% endif %}{% endblock title %}</title>
  <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}" type="text/css" media="screen">
  <link rel="stylesheet" href="{% static 'css/font-awesome.css' %}" type="text/css" media="screen">
  <link rel="stylesheet" href="{% static 'chosen/chosen.css' %}" type="text/css" media="screen">
  <link rel="stylesheet" href="{% static 'css/velociraptor.css' %}" type="text/css" media="screen">
  <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
  </style>
  <link rel="stylesheet" href="{% static 'css/bootstrap-responsive.css' %}" type="text/css" media="screen">
  {% block style %}{% endblock style %}
  {% if custom_css %}
    <link rel="stylesheet" href="{{ custom_css }}" type="text/css" media="screen">
  {% endif %}
</head>
<body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/">{% if site_title %}{{ site_title }}{% else %}Velociraptor{% endif %}</a>
          <div class="nav-collapse">
          {% block nav %}
          {% if not hide_nav %}
            {% url dash as dash_url %}
            {% url build_hg as build_url %}
            {% url release as release_url %}
            {% url deploy as deploy_url %}
            {% url log as log_url %}
            <ul class="nav">
              <li class="{% current_nav dash_url %}"><a href="{{ dash_url }}">Dash</a></li>
              <li class="{% current_nav log_url %}"><a href="{{ log_url }}">Log</a></li>
              <li class="dropdown">

                  <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                      Actions
                      <b class="caret"></b>
                  </a>
                  <ul class="dropdown-menu">
                      <li class="{% current_nav build_url %}"><a href="{{ build_url }}">Build</a></li>
                      <li class="{% current_nav release_url %}"><a href="{{ release_url }}">Release</a></li>
                      <li class="{% current_nav deploy_url %}"><a href="{{ deploy_url }}">Deploy</a></li>
                  </ul>
              </li>
              <li class="dropdown">
                  <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                    Squads
                      <b class="caret"></b>
                  </a>
                  <ul class="dropdown-menu">
                      {% for squad in squads %}
                      <li><a href="{% url edit_squad squad.id %}">{{ squad.name }}</a></li>
                      {% endfor %}
                  </ul>
              </li>
              <li class="dropdown">
                  <select class="chzn-select nav-select" data-placeholder="Swarms" style="display: none;">
                       
                      <option></option>
                      <option value="/swarm/">New</option>
                      {% for swarm in swarms %}
                      <option value="{% url edit_swarm swarm.id %}">{{ swarm.shortname }}</option>
                      {% endfor %}
                  </select>
              </li>
            </ul>
            <p class="navbar-text pull-right">
            {% if request.user.is_authenticated %}
            Logged in as {{ request.user.username }}.  <a href="{% url logout %}">Log out</a>
            {% else %}

            {% endif %}
            </p>
          {% endif %}
          {% endblock nav %}
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>
    {% if messages %}
        <div class="container-fluid">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
             <a class="close" data-dismiss="alert">×</a>
            {{ message }}
        </div>
        {% endfor %}
        </div>
    {% endif %}
    <div class="container-fluid">
        {% block content %}
        {% endblock content %}
    </div>
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script src="{% static 'chosen/chosen.jquery.min.js' %}"></script>
    <script src="{% static 'js/django-jquery.js' %}"></script>
    <script src="{% static 'js/underscore-min.js' %}"></script>
    <script src="{% static 'js/goatee.js' %}"></script>
    <script src="{% static 'js/bootstrap.js' %}"></script>
    <script src="{% static 'js/vr.js' %}"></script>

    <script>{# set up the fancy nav dropdowns #}
    $(document).ready(function() {
        $(".chzn-select").chosen({ search_contains: true });
        {# Go to new page when selecting from the nav Chosen dropdowns. #}
        $('.nav-select').change(function(ev){
            window.location = $(this).val();
        });
      });
    </script>

{# GOATEE TEMPLATES #}

<script id="app-tmpl" type="text/goatee">
  <td class="titlecell"><h2 class="apptitle"><%id%></h2></td><td class="proccell"></td>
</script>

<script id="swarm-tmpl" type="text/goatee">
  <div class="procgrid">
    <h4 class="swarmtitle"><%id%></h4>
  </div>
</script>

<script id="proc-tmpl" type="text/goatee">
<div class="procbox <%statename%>" id="proc-<%jsname%>"></div>
</script>

<script id="proc-details-tmpl" type="text/goatee">
    <div class="modal proc-details-modal" data-host="<%host%>" data-name="<%name%>">
      <div class="modal-header">
          <a class="close" data-dismiss="modal">×</a>
          <h3><%name%> </h3>
          on <a href="http://<%host%>:<%port%>"><%host%>:<%port%></a>
      </div>
      <div class="modal-body procmodal-<%statename%>">
          <table class="attrs">
              <tr><th class="rowlabel">Name</th><td><%name%></td></tr>
              <tr><th class="rowlabel">Description</th><td><%description%></td></tr>
              <tr><th class="rowlabel">State</th><td>
                  <div class="procbox <%statename%>"></div>
                  <%statename%>
              </td></tr>
              <tr><th class="rowlabel">App</th><td><%app%></td></tr>
              <tr><th class="rowlabel">Tag</th><td><%tag%></td></tr>
              <tr><th class="rowlabel">Config Recipe</th><td><%recipe%></td></tr>
              <tr><th class="rowlabel">Release Hash</th><td><%hash%></td></tr>
              <tr><th class="rowlabel">Proc Name</th><td><%proc%></td></tr>
              <tr><th class="rowlabel">Host</th><td><%host%></td></tr>
              <tr><th class="rowlabel">Port</th><td><%port%></td></tr>
              <tr><th class="rowlabel"></th><td>
                <button class="proc-destroy btn btn-danger">Destroy</button>
                <button class="proc-stop btn btn-warning ifrunning">Stop</button>
                <button class="proc-restart btn btn-warning ifrunning">Restart</button>
                <button class="proc-start btn btn-success ifstopped">Start</button>
              </td></tr>
          </table>
      </div>
    </div>
</script>
{# /GOATEE TEMPLATES #}

{% block script %}{% endblock script %}
</body>
</html>
